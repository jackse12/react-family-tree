(this["webpackJsonpfamily-chart-react"]=this["webpackJsonpfamily-chart-react"]||[]).push([[0],{14:function(e){e.exports=JSON.parse('[{"id":"0","rels":{"spouses":null,"father":null,"mother":null,"children":null},"data":{"first name":"Agnus","last name":"","birthday":"1970","avatar":"https://static8.depositphotos.com/1009634/988/v/950/depositphotos_9883921-stock-illustration-no-user-profile-picture.jpg","gender":"M"}}]')},23:function(e,t,n){e.exports=n(41)},28:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var a=n(3),r=n.n(a),o=n(22),i=n.n(o),c=n(16),s=n(0),d=n(1),l=n(6),u=n(9),f=n(11),p=n(15),h=n.n(p),m=(n(28),n(17)),v=n.n(m);n(29);function x(e){var t=e.datum,n=e.rel_datum,a=e.store,r=e.rel_type,o=e.card_edit,i=e.postSubmit,c=e.card_display,s=e.edit,d=s.el,l=s.open,u=s.close;function f(e){e.preventDefault(),new FormData(e.target).forEach((function(e,n){return t.data[n]=e})),u(),i()}function p(){u(),i({delete:!0})}d.innerHTML='\n      <div class="modal-content">\n        <form>\n          <div>\n            <div style="text-align: left">\n              <span style="display: '.concat(t.to_add||n?"none":null,'; float: right; cursor: pointer" class="red-text delete">delete</span>\n            </div>\n            <div>\n              <label><input type="radio" name="gender" value="M" ').concat("M"===t.data.gender?"checked":"",'><span>male</span></label><br>\n              <label><input type="radio" name="gender" value="F" ').concat("F"===t.data.gender?"checked":"","><span>female</span></label><br>\n            </div>\n          </div>\n          ").concat(function(e){return e.map((function(e){return"text"===e.type?'<input type="text" name="'.concat(e.key,'" placeholder="').concat(e.placeholder,'" value="').concat(t.data[e.key]||"",'">'):"textarea"===e.type?'<textarea class="materialize-textarea" name="'.concat(e.key,'" placeholder="').concat(e.placeholder,'">').concat(t.data[e.key]||"","</textarea>"):""})).join("\n")}(o),"\n          ").concat("son"===r||"daughter"===r?function(){var e=a.getData();return'\n      <div>\n        <label>Select other</label>\n        <select name="other_parent" style="display: block">\n          '.concat(n.rels.spouses&&0!==n.rels.spouses.length?n.rels.spouses.map((function(t,n){var a=e.find((function(e){return e.id===t}));return'<option value="'.concat(t,'" ').concat(0===n?"selected":"",">").concat(c[0](a),"</option>")})).join("\n"):"",'\n          <option value="',"_new",'">NEW</option>\n        </select>\n      </div>\n    ')}():"",'\n          <br><br>\n          <div style="text-align: center">\n            <button type="submit" class="btn">submit</button>\n          </div>\n        </form>\n      </div>\n    '),d.querySelector("form").addEventListener("submit",f),d.querySelector(".delete").addEventListener("click",p),l()}var y=n(14),g=n(12),_=n(2),b="object"===typeof window&&window.d3?window.d3:g;function E(e,t,n){return n.find((function(n){return n.id!==t.id&&(n.id===e.rels.mother||n.id===e.rels.father)}))}function k(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(n){var a=16*Math.random();return e>0?(a=(e+a)%16|0,e=Math.floor(e/16)):(a=(t+a)%16|0,t=Math.floor(t/16)),("x"===n?a:3&a|8).toString(16)}))}function w(e){var t=e.data,n=e.rels;return{id:k(),data:t||{},rels:n||{}}}function S(e){var t,n=e.data_stash,a=e.main_id,r=void 0===a?null:a,o=e.is_vertical,i=void 0===o||o,c=e.node_separation,s=void 0===c?250:c,d=e.level_separation,l=void 0===d?150:d;n=function(e){for(var t=[],n=function(){var n=e[a];if(n.rels.children&&n.rels.children.length>0){n.rels.spouses||(n.rels.spouses=[]);var r,o="M"===n.data.gender;n.rels.children.forEach((function(a){var i=e.find((function(e){return e.id===a}));i.rels[o?"father":"mother"]===n.id&&(i.rels[o?"mother":"father"]||(r||(r=function(e){var n=w({data:{gender:"M"===e.data.gender?"F":"M"},rels:{spouses:[e.id],children:[]}});return n.to_add=!0,t.push(n),n}(n),n.rels.spouses.push(r.id)),r.rels.children.push(i.id),i.rels[o?"mother":"father"]=r.id))}))}},a=0;a<e.length;a++)n();return t.forEach((function(t){return e.push(t)})),e}(n),(t=n).forEach((function(e){e.rels.children&&e.rels.children.sort((function(n,a){var r=t.find((function(e){return e.id===n})),o=t.find((function(e){return e.id===a})),i=E(r,e,t)||{},c=E(o,e,t)||{},s=e.rels.spouses.indexOf(i.id),d=e.rels.spouses.indexOf(c.id);return"M"===e.data.gender?s-d:d-s}))}));var u=null!==r?n.find((function(e){return e.id===r})):n[0],f=y(u,"children",!1),p=y(u,"parents",!0);n.forEach((function(e){return e.main=e===u})),function(e,t){var n=(e[0].x-t[0].x)/2;e.forEach((function(e){return e.x-=n})),t.forEach((function(e){return e.x+=n}))}(p,f);var h,m,v=(m=f,(h=p).forEach((function(e){e.is_ancestry=!0})),h.forEach((function(e){return 1===e.depth?e.parent=m[0]:null})),[].concat(Object(_.a)(m),Object(_.a)(h.slice(1))));!function(e){var t=e.tree;t.forEach((function(e){delete e.children,t.forEach((function(t){t.parent===e&&(t.is_ancestry?(e.parents||(e.parents=[]),e.parents.push(t)):(e.children||(e.children=[]),e.children.push(t)))}))}))}({tree:v}),function(e){for(var t=e.tree,a=e.node_separation,r=function(){var e=t[o];if(!e.is_ancestry&&e.data.rels.spouses&&e.data.rels.spouses.length>0){var r="M"===e.data.data.gender?-1:1;e.x+=e.data.rels.spouses.length/2*a*r,e.data.rels.spouses.forEach((function(o,i){var c={data:n.find((function(e){return e.id===o})),added:!0};c.x=e.x-a*(i+1)*r,c.y=e.y,c.sx=i>0?c.x:c.x+a/2*r,c.depth=e.depth,c.spouse=e,e.spouses||(e.spouses=[]),e.spouses.push(c),t.push(c),t.forEach((function(t){return t.data.rels.father===e.data.id&&t.data.rels.mother===c.data.id||t.data.rels.mother===e.data.id&&t.data.rels.father===c.data.id?t.psx=c.sx:null}))}))}if(e.parents&&2===e.parents.length){var i=e.parents[0],c=e.parents[1],s=i.x-(i.x-c.x)/2,d=function(e,t){return s+a/2*(e.x<t.x?1:-1)};c.x=d(i,c),i.x=d(c,i)}},o=t.length;o--;)r()}({tree:v,node_separation:s}),function(e){var t=e.tree,n=e.is_vertical;t.forEach((function(e){if(e.y*=e.is_ancestry?-1:1,!n){var t=e.x;e.x=e.y,e.y=t}}))}({tree:v,is_vertical:i});var x=function(e,t,n,a){if(!a){var r=[n,t];t=r[0],n=r[1]}var o=b.extent(e,(function(e){return e.x})),i=b.extent(e,(function(e){return e.y}));return{width:o[1]-o[0]+t,height:i[1]-i[0]+n,x_off:-o[0]+t/2,y_off:-i[0]+n/2}}(v,s,l,i);return{data:v,data_stash:n,dim:x};function y(e,t,a){var r="children"===t?function(e){return Object(_.a)(e.rels.children||[]).map((function(e){return n.find((function(t){return t.id===e}))}))}:function(e){return[e.rels.father,e.rels.mother].filter((function(e){return e})).map((function(e){return n.find((function(t){return t.id===e}))}))},o=b.tree().nodeSize([s,l]).separation((function(e,t){var n=1;a||(c(e,t)||(n+=.25),function(e,t){return d(e)||d(t)}(e,t)&&(n+=function(e,t){return.5*Math.max((e.data.rels.spouses||[]).length,(t.data.rels.spouses||[]).length)+.5}(e,t)),c(e,t)&&!function(e,t){return e.data.rels.father===t.data.rels.father&&e.data.rels.mother===t.data.rels.mother}(e,t)&&(n+=.125));return n})),i=b.hierarchy(e,r);return o(i),i.descendants();function c(e,t){return e.parent==t.parent}function d(e){return e.data.rels.spouses&&e.data.rels.spouses.length>0}}}n(31);function O(e){var t,n=e,a={tree:function(e){n.tree=(console.log("This is it",n.data),localStorage.setItem("treeData",JSON.stringify(n.data)),S({data_stash:n.data,main_id:n.main_id,node_separation:n.node_separation,level_separation:n.level_separation})),t&&t(e)},mainId:function(e){return n.main_id=e},data:function(e){return n.data=e}};return{state:n,update:a,getData:function(){return n.data},getTree:function(){return n.tree},setOnUpdate:function(e){return t=e},methods:{}}}var M=function(e){Object(u.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(s.a)(this,n),(a=t.call(this,e)).chartRef=r.a.createRef(),a.contRef=r.a.createRef(),a.handleF3=a.handleF3.bind(Object(l.a)(a)),a.state={chartState:null},a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){if(this.contRef.current){var e=y;null===localStorage.getItem("treeData")?(console.log("NOt retain"),localStorage.setItem("treeData",JSON.stringify(y))):(console.log("reteain"),e=localStorage.getItem("treeData"),e=JSON.parse(e)),function(){var t=document.querySelector("#chart"),n={w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},a=function(){var e=function(e){return"".concat(e.data["first name"]||""," ").concat(e.data["last name"]||"")},t=function(e){return"".concat(e.data.birthday||"")};return e.create_form="{first name} {last name}",t.create_form="{birthday}",[e,t]}(),r=[{type:"text",placeholder:"first name",key:"first name"},{type:"text",placeholder:"last name",key:"last name"},{type:"text",placeholder:"birthday",key:"birthday"},{type:"text",placeholder:"avatar",key:"avatar"}],o=O({data:e,card_display:[function(e){return e.data.label||""},function(e){return e.data.desc||""}],mini_tree:!0,hide_rels:!0,node_separation:250,level_separation:150,custom_elements:[{el:j(n),lis:D,query:".customAddBtn"}],card_dim:n}),i=h.a.d3AnimationView({store:o,cont:document.querySelector("#chart"),card_edit:r}),s=h.a.elements.Card({store:o,svg:i.svg,card_dim:{w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},card_display:[function(e){return"".concat(e.data["first name"]||""," ").concat(e.data["last name"]||"")},function(e){return"".concat(e.data.birthday||"")}],cardEditForm:d,addRelative:h.a.handlers.AddRelative({store:o,cont:t,card_dim:n,cardEditForm:d,labels:{mother:"Add mother"}}),mini_tree:!0,link_break:!1});function d(e){var t=e.postSubmit;e.postSubmit=function(e){t(e),console.log("ps_props",t)};var n=document.querySelector("#form_modal"),o=v.a.Modal.getInstance(n),i={el:n,open:function(){return o.open()},close:function(){return o.close()}};x(Object(c.a)(Object(c.a)({},e),{},{card_edit:r,card_display:a,edit:i}))}i.setCard(s),o.setOnUpdate((function(e){return i.update(e||{})})),o.update.tree({initial:!0}),console.log("store",o);var l=document.body.appendChild(document.createElement("div"));l.setAttribute("id","form_modal"),l.setAttribute("class","modal"),v.a.Modal.init(l)}()}}},{key:"handleF3",value:function(){document.getElementById("chart").chartInstance}},{key:"render",value:function(){return r.a.createElement("div",{style:{display:"flex",justifyContent:"flex-start",maxWidth:"100%",margin:"auto"}},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"f3",id:"chart",ref:this.contRef,style:{position:"relative"}})),r.a.createElement("div",{id:"form_data",className:"modal"}))}}]),n}(r.a.Component);function j(e){return'\n    <g class="customAddBtn" style="cursor: pointer">\n      <g transform="translate('.concat(e.w-12,",").concat(e.h-12,')scale(.08)">\n        <circle r="100" fill="#fff" />\n        <g transform="translate(-50,-45)">\n          <line\n            x1="10" x2="90" y1="50" y2="50"\n            stroke="currentColor" stroke-width="20" stroke-linecap="round"\n          />\n          <line\n            x1="50" x2="50" y1="10" y2="90"\n            stroke="currentColor" stroke-width="20" stroke-linecap="round"\n          />\n        </g>\n      </g>\n    </g>\n  ')}function D(e,t){console.log(t.card),console.log(t.d)}n(40);function N(){return r.a.createElement("div",{className:"App",style:{width:"100%"}},r.a.createElement(M,null))}var A=document.getElementById("root");i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(N,null)),A)}},[[23,1,2]]]);
//# sourceMappingURL=main.1032a30d.chunk.js.map